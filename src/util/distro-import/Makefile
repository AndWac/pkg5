#
# CDDL HEADER START
#
# The contents of this file are subject to the terms of the
# Common Development and Distribution License (the "License").
# You may not use this file except in compliance with the License.
#
# You can obtain a copy of the license at usr/src/OPENSOLARIS.LICENSE
# or http://www.opensolaris.org/os/licensing.
# See the License for the specific language governing permissions
# and limitations under the License.
#
# When distributing Covered Code, include this CDDL HEADER in each
# file and include the License file at usr/src/OPENSOLARIS.LICENSE.
# If applicable, add the following below this CDDL HEADER, with the
# fields enclosed by brackets "[]" replaced with your own identifying
# information: Portions Copyright [yyyy] [name of copyright owner]
#
# CDDL HEADER END
#

#
# Copyright (c) 2007, 2011, Oracle and/or its affiliates. All rights reserved.
#

include ../Makefile.buildnum

#set default
ARCH=i386
NATIVE_ARCH:sh = uname -p
PROTO_AREA=../../../proto/root_$(NATIVE_ARCH)

#
# Needs to point to filesystem on Solaris install dvd
# replace as needed with a local solaris install image
#
WOS_PKGS_BASE=/net/pkgdock.us.oracle.com/export/integrate_dock/nv/nv_solnext_$(TRUNKID)
WOS_PKGS=$(WOS_PKGS_BASE)/$(ARCH)
WOS_EXTRA_PKGS=$(WOS_PKGS_BASE)/all
NONWOS_DOCK=
NONWOS_PKGS=

TEST_PKGS=
REPO=http://localhost:10000

ON_REPO=http://localhost:20000
ON_BRANCHID=$(BRANCHID)
ON_INCORPORATION=consolidation/osnet/osnet-incorporation@0.5.11-0.$(ON_BRANCHID)

INSTALL_REPO=http://localhost:20001
INSTALL_BRANCHID=$(BRANCHID)
INSTALL_INCORPORATION=consolidation/install/install-incorporation@0.5.11-0.$(INSTALL_BRANCHID)

X_REPO=http://localhost:20002
X_BRANCHID=$(BRANCHID)
X_INCORPORATION=consolidation/X/X-incorporation@0.5.11-0.$(X_BRANCHID)

IPS_REPO=http://localhost:20003
IPS_BRANCHID=$(BRANCHID)
IPS_INCORPORATION=consolidation/ips/ips-incorporation@0.5.11-0.$(IPS_BRANCHID)

VPANELS_REPO=http://localhost:20004
VPANELS_BRANCHID=$(BRANCHID)
VPANELS_INCORPORATION=consolidation/vpanels/vpanels-incorporation@0.5.11-0.$(VPANELS_BRANCHID)

USERLAND_REPO=http://localhost:20005
USERLAND_BRANCHID=$(BRANCHID)
USERLAND_INCORPORATION=consolidation/userland/userland-incorporation@0.5.11-0.$(USERLAND_BRANCHID)

L10N_REPO=http://localhost:20006
L10N_BRANCHID=$(BRANCHID)
L10N_INCORPORATION=consolidation/l10n/l10n-incorporation@0.5.11-0.$(L10N_BRANCHID)

DESKTOP_REPO=http://localhost:20007
DESKTOP_BRANCHID=$(BRANCHID)
DESKTOP_INCORPORATION=consolidation/desktop/desktop-incorporation@0.5.11-0.$(DESKTOP_BRANCHID)
DESKTOP_GNOME_INCORPORATION=consolidation/desktop/gnome-incorporation@0.5.11-0.$(DESKTOP_BRANCHID)

CDE_REPO=http://localhost:20008
CDE_BRANCHID=$(BRANCHID)
CDE_INCORPORATION=consolidation/cde/cde-incorporation@0.5.11-0.$(CDE_BRANCHID)

FOSS_REPO=http://localhost:20009
FOSS_BRANCHID=$(BRANCHID)

CACAO_REPO=http://localhost:20010
CACAO_BRANCHID=$(BRANCHID)
CACAO_INCORPORATION=consolidation/cacao/cacao-incorporation@0.5.11-0.$(CACAO_BRANCHID)

CNS_REPO=http://localhost:20011
CNS_BRANCHID=$(BRANCHID)
CNS_INCORPORATION=consolidation/cns/cns-incorporation@0.5.11-0.$(CNS_BRANCHID)

JDMK_REPO=http://localhost:20012
JDMK_BRANCHID=$(BRANCHID)
JDMK_INCORPORATION=consolidation/jdmk/jdmk-incorporation@0.5.11-0.$(JDMK_BRANCHID)

NVIDIA_REPO=http://localhost:20013
NVIDIA_BRANCHID=$(BRANCHID)
NVIDIA_INCORPORATION=consolidation/nvidia/nvidia-incorporation@0.5.11-0.$(NVIDIA_BRANCHID)

DEVPRO_REPO=http://localhost:20014
DEVPRO_BRANCHID=$(BRANCHID)
DEVPRO_INCORPORATION=consolidation/sunpro/sunpro-incorporation@0.5.11-0.$(DEVPRO_BRANCHID)

SOLARIS_RE_REPO=http://localhost:20015
SOLARIS_RE_BRANCHID=$(BRANCHID)
SOLARIS_RE_INCORPORATION=consolidation/solaris_re/solaris_re-incorporation@0.5.11-0.$(SOLARIS_RE_BRANCHID)

MAN_REPO=http://localhost:20016
MAN_BRANCHID=$(BRANCHID)
MAN_INCORPORATION=consolidation/man/man-incorporation@0.5.11-0.$(MAN_BRANCHID)

LDOMS_REPO=http://localhost:20017
LDOMS_BRANCHID=$(BRANCHID)
LDOMS_INCORPORATION=consolidation/ldoms/ldoms-incorporation@0.5.11-0.$(LDOMS_BRANCHID)

SIC_TEAM_REPO=http://localhost:20018
SIC_TEAM_BRANCHID=$(BRANCHID)
SIC_TEAM_INCORPORATION=consolidation/sic_team/sic_team-incorporation@0.5.11-0.$(SIC_TEAM_BRANCHID)

SUNVTS_REPO=http://localhost:20019
SUNVTS_BRANCHID=$(BRANCHID)
SUNVTS_INCORPORATION=consolidation/SunVTS/SunVTS-incorporation@0.5.11-0.$(SUNVTS_BRANCHID)

JAVA_REPO=http://localhost:20020
JAVA_BRANCHID=$(BRANCHID)
JAVA_INCORPORATION=consolidation/java/java-incorporation@0.5.11-0.$(JAVA_BRANCHID)

REF_REPO=http://ipkg.us.oracle.com/release
REF_URIS=$(REF_REPO)@solaris@0.5.11,5.11-0.$(BRANCHID)

JUST_THESE_PKGS=
EXTRA_ENTIRE_CONTENTS=

ALL_PKGS=	../../../packages/$(ARCH)	\
		$(TEST_PKGS)			\
		$(NONWOS_PKGS)			\
		$(WOS_EXTRA_PKGS)		\
		$(WOS_PKGS) .

POUND_SIGN:sh=				echo \\043

i386_DEFINES=		\
	ARCH=i386	\
	ARCH32=i86	\
	ARCH64=amd64	\
	i386_ONLY=''	\
	sparc_ONLY=$(POUND_SIGN)

sparc_DEFINES=		\
	ARCH=sparc	\
	ARCH32=sparcv7	\
	ARCH64=sparcv9	\
	i386_ONLY=$(POUND_SIGN)	\
	sparc_ONLY=''

ARCH_DEFINES=$($(ARCH)_DEFINES)

EXTRA_OPTIONS=

OSNET_CONSOLIDATION_OPTIONS = \
	-C osnet \
	-R $(ON_REPO)@$(ON_INCORPORATION) \
	-E $(ON_INCORPORATION) \
	-J developer/build/onbld -J developer/opensolaris/osnet

INSTALL_CONSOLIDATION_OPTIONS = \
	-C install \
	-R $(INSTALL_REPO)@$(INSTALL_INCORPORATION) \
	-E $(INSTALL_INCORPORATION)

X_CONSOLIDATION_OPTIONS = \
	-C X \
	-R $(X_REPO)@$(X_INCORPORATION) \
	-E $(X_INCORPORATION)

IPS_CONSOLIDATION_OPTIONS = \
	-C ips \
	-R $(IPS_REPO)@$(IPS_INCORPORATION) \
	-E $(IPS_INCORPORATION)

VPANELS_CONSOLIDATION_OPTIONS = \
	-C vpanels \
	-R $(VPANELS_REPO)@$(VPANELS_INCORPORATION) \
	-E $(VPANELS_INCORPORATION)

USERLAND_CONSOLIDATION_OPTIONS = \
	-C userland \
	-R $(USERLAND_REPO)@$(USERLAND_INCORPORATION) \
	-E $(USERLAND_INCORPORATION)

L10N_CONSOLIDATION_OPTIONS = \
	-C l10n \
	-R $(L10N_REPO)@$(L10N_INCORPORATION) \
	-E $(L10N_INCORPORATION)

DESKTOP_CONSOLIDATION_OPTIONS = \
	-C desktop \
	-R $(DESKTOP_REPO)@$(DESKTOP_GNOME_INCORPORATION) \
	-E $(DESKTOP_GNOME_INCORPORATION) \
	-R $(DESKTOP_REPO)@$(DESKTOP_INCORPORATION) \
	-E $(DESKTOP_INCORPORATION)

CDE_CONSOLIDATION_OPTIONS = \
	-C cde \
	-R $(CDE_REPO)@$(CDE_INCORPORATION) \
	-E $(CDE_INCORPORATION)

FOSS_CONSOLIDATION_OPTIONS =

CACAO_CONSOLIDATION_OPTIONS = \
	-C cacao \
	-R $(CACAO_REPO)@$(CACAO_INCORPORATION) \
	-E $(CACAO_INCORPORATION)

CNS_CONSOLIDATION_OPTIONS = \
	-C cns \
	-R $(CNS_REPO)@$(CNS_INCORPORATION) \
	-E $(CNS_INCORPORATION)

JDMK_CONSOLIDATION_OPTIONS = \
	-C jdmk \
	-R $(JDMK_REPO)@$(JDMK_INCORPORATION) \
	-E $(JDMK_INCORPORATION)

NVIDIA_CONSOLIDATION_OPTIONS = \
	-C nvidia \
	-R $(NVIDIA_REPO)@$(NVIDIA_INCORPORATION) \
	-E $(NVIDIA_INCORPORATION)

DEVPRO_CONSOLIDATION_OPTIONS = \
	-C sunpro \
	-R $(DEVPRO_REPO)@$(DEVPRO_INCORPORATION) \
	-E $(DEVPRO_INCORPORATION)

SOLARIS_RE_CONSOLIDATION_OPTIONS = \
	-C solaris_re \
	-R $(SOLARIS_RE_REPO)@$(SOLARIS_RE_INCORPORATION) \
	-E $(SOLARIS_RE_INCORPORATION)

MAN_CONSOLIDATION_OPTIONS = \
	-C man \
	-R $(MAN_REPO)@$(MAN_INCORPORATION) \
	-E $(MAN_INCORPORATION)

LDOMS_CONSOLIDATION_OPTIONS = \
	-C ldoms \
	-R $(LDOMS_REPO)@$(LDOMS_INCORPORATION) \
	-E $(LDOMS_INCORPORATION)

SIC_TEAM_CONSOLIDATION_OPTIONS = \
	-C sic_team \
	-R $(SIC_TEAM_REPO)@$(SIC_TEAM_INCORPORATION) \
	-E $(SIC_TEAM_INCORPORATION)

SUNVTS_CONSOLIDATION_OPTIONS = \
	-C SunVTS \
	-R $(SUNVTS_REPO)@$(SUNVTS_INCORPORATION) \
	-E $(SUNVTS_INCORPORATION)

JAVA_CONSOLIDATION_OPTIONS = \
	-C java \
	-R $(JAVA_REPO)@$(JAVA_INCORPORATION) \
	-E $(JAVA_INCORPORATION)

SFW_CONSOLIDATION_OPTIONS =

CONSOLIDATION_OPTIONS_136 = \
	$(OSNET_CONSOLIDATION_OPTIONS)
CONSOLIDATION_OPTIONS_137 = $(CONSOLIDATION_OPTIONS_136)
CONSOLIDATION_OPTIONS_138 = $(CONSOLIDATION_OPTIONS_136)
CONSOLIDATION_OPTIONS_139 = $(CONSOLIDATION_OPTIONS_136)
CONSOLIDATION_OPTIONS_140 = $(CONSOLIDATION_OPTIONS_136)
CONSOLIDATION_OPTIONS_141 = $(CONSOLIDATION_OPTIONS_136)
CONSOLIDATION_OPTIONS_142 = $(CONSOLIDATION_OPTIONS_136)
CONSOLIDATION_OPTIONS_143 = $(CONSOLIDATION_OPTIONS_136) \
	$(INSTALL_CONSOLIDATION_OPTIONS)
CONSOLIDATION_OPTIONS_144 = $(CONSOLIDATION_OPTIONS_143) \
	$(X_CONSOLIDATION_OPTIONS)
CONSOLIDATION_OPTIONS_145 = $(CONSOLIDATION_OPTIONS_144) \
	$(IPS_CONSOLIDATION_OPTIONS)
CONSOLIDATION_OPTIONS_146 = $(CONSOLIDATION_OPTIONS_145)
CONSOLIDATION_OPTIONS_147 = $(CONSOLIDATION_OPTIONS_145)
CONSOLIDATION_OPTIONS_148 = $(CONSOLIDATION_OPTIONS_145) \
	$(VPANELS_CONSOLIDATION_OPTIONS)
CONSOLIDATION_OPTIONS_149 = $(CONSOLIDATION_OPTIONS_148)
CONSOLIDATION_OPTIONS_150 = $(CONSOLIDATION_OPTIONS_148)
CONSOLIDATION_OPTIONS_151 = $(CONSOLIDATION_OPTIONS_148)
CONSOLIDATION_OPTIONS_151.0.1 = $(CONSOLIDATION_OPTIONS_148)
CONSOLIDATION_OPTIONS_152 = $(CONSOLIDATION_OPTIONS_148)
CONSOLIDATION_OPTIONS_153 = $(CONSOLIDATION_OPTIONS_148)
CONSOLIDATION_OPTIONS_154 = $(CONSOLIDATION_OPTIONS_148)
CONSOLIDATION_OPTIONS_155 = $(CONSOLIDATION_OPTIONS_148) \
	$(USERLAND_CONSOLIDATION_OPTIONS) \
	$(L10N_CONSOLIDATION_OPTIONS)
CONSOLIDATION_OPTIONS_156 = $(CONSOLIDATION_OPTIONS_155)
CONSOLIDATION_OPTIONS_157 = $(CONSOLIDATION_OPTIONS_155)
CONSOLIDATION_OPTIONS_158 = $(CONSOLIDATION_OPTIONS_155)
CONSOLIDATION_OPTIONS_159 = $(CONSOLIDATION_OPTIONS_155)
CONSOLIDATION_OPTIONS_160 = $(CONSOLIDATION_OPTIONS_155)
CONSOLIDATION_OPTIONS_161 = $(CONSOLIDATION_OPTIONS_155)
CONSOLIDATION_OPTIONS_162 = $(CONSOLIDATION_OPTIONS_155)
CONSOLIDATION_OPTIONS_163 = $(CONSOLIDATION_OPTIONS_155) \
	$(DESKTOP_CONSOLIDATION_OPTIONS)
CONSOLIDATION_OPTIONS_164 = $(CONSOLIDATION_OPTIONS_163)
CONSOLIDATION_OPTIONS_165 = $(CONSOLIDATION_OPTIONS_163) \
	$(CDE_CONSOLIDATION_OPTIONS) \
	$(FOSS_CONSOLIDATION_OPTIONS)
CONSOLIDATION_OPTIONS_166 = $(CONSOLIDATION_OPTIONS_165) \
	$(CACAO_CONSOLIDATION_OPTIONS) \
	$(CNS_CONSOLIDATION_OPTIONS) \
	$(JDMK_CONSOLIDATION_OPTIONS) \
	$(NVIDIA_CONSOLIDATION_OPTIONS) \
	$(SFW_CONSOLIDATION_OPTIONS)
CONSOLIDATION_OPTIONS_167 = $(CONSOLIDATION_OPTIONS_166)
CONSOLIDATION_OPTIONS_168 = $(CONSOLIDATION_OPTIONS_166) \
	$(DEVPRO_CONSOLIDATION_OPTIONS)
CONSOLIDATION_OPTIONS_169 = $(CONSOLIDATION_OPTIONS_168) \
	$(SOLARIS_RE_CONSOLIDATION_OPTIONS)
CONSOLIDATION_OPTIONS_170 = $(CONSOLIDATION_OPTIONS_169)
CONSOLIDATION_OPTIONS_171 = $(CONSOLIDATION_OPTIONS_169) \
	$(MAN_CONSOLIDATION_OPTIONS) \
	$(LDOMS_CONSOLIDATION_OPTIONS)
CONSOLIDATION_OPTIONS_172 = $(CONSOLIDATION_OPTIONS_171) \
	$(SIC_TEAM_CONSOLIDATION_OPTIONS) \
	$(SUNVTS_CONSOLIDATION_OPTIONS) \
	$(JAVA_CONSOLIDATION_OPTIONS)
CONSOLIDATION_OPTIONS_173 = $(CONSOLIDATION_OPTIONS_172)
CONSOLIDATION_OPTIONS_174.0.0.0.0.0 = $(CONSOLIDATION_OPTIONS_172)
CONSOLIDATION_OPTIONS_175.0.0.0.0.0 = $(CONSOLIDATION_OPTIONS_172)
CONSOLIDATION_OPTIONS_175.0.0.0.1.0 = $(CONSOLIDATION_OPTIONS_172)
CONSOLIDATION_OPTIONS_175.0.0.0.2.0 = $(CONSOLIDATION_OPTIONS_172)
CONSOLIDATION_OPTIONS = $(CONSOLIDATION_OPTIONS_$(BRANCHID))

GLOBAL_CHATTRS_BASE=	\
	reboot		\
	smf_manifests

GLOBAL_CHATTRS_86 = $(GLOBAL_CHATTRS_BASE)
GLOBAL_CHATTRS_89 = $(GLOBAL_CHATTRS_BASE)
GLOBAL_CHATTRS_90 = $(GLOBAL_CHATTRS_BASE)
GLOBAL_CHATTRS_91 = $(GLOBAL_CHATTRS_BASE)
GLOBAL_CHATTRS_92 = $(GLOBAL_CHATTRS_BASE)
GLOBAL_CHATTRS_93 = $(GLOBAL_CHATTRS_BASE)
GLOBAL_CHATTRS_94 = $(GLOBAL_CHATTRS_BASE)
GLOBAL_CHATTRS_95 = $(GLOBAL_CHATTRS_BASE)
GLOBAL_CHATTRS_96 = $(GLOBAL_CHATTRS_BASE)
GLOBAL_CHATTRS_97 = $(GLOBAL_CHATTRS_BASE)
GLOBAL_CHATTRS_98 = $(GLOBAL_CHATTRS_BASE)
GLOBAL_CHATTRS_99 = $(GLOBAL_CHATTRS_BASE)
GLOBAL_CHATTRS_100a = $(GLOBAL_CHATTRS_BASE)
GLOBAL_CHATTRS_101 = $(GLOBAL_CHATTRS_BASE) fonts gnome
GLOBAL_CHATTRS_101a = $(GLOBAL_CHATTRS_101)
GLOBAL_CHATTRS_105 = $(GLOBAL_CHATTRS_101)
GLOBAL_CHATTRS_106 = $(GLOBAL_CHATTRS_101) variants
GLOBAL_CHATTRS_107 = $(GLOBAL_CHATTRS_106)
GLOBAL_CHATTRS_108 = $(GLOBAL_CHATTRS_106)
GLOBAL_CHATTRS_109 = $(GLOBAL_CHATTRS_106)
GLOBAL_CHATTRS_110 = $(GLOBAL_CHATTRS_106)
GLOBAL_CHATTRS_111 = $(GLOBAL_CHATTRS_106)
GLOBAL_CHATTRS_111a = $(GLOBAL_CHATTRS_106)
GLOBAL_CHATTRS_116 = $(GLOBAL_CHATTRS_106)
GLOBAL_CHATTRS_117 = $(GLOBAL_CHATTRS_106)
GLOBAL_CHATTRS_118 = $(GLOBAL_CHATTRS_106)
GLOBAL_CHATTRS_119 = $(GLOBAL_CHATTRS_106)
GLOBAL_CHATTRS_120 = $(GLOBAL_CHATTRS_106)
GLOBAL_CHATTRS_121 = $(GLOBAL_CHATTRS_106)
GLOBAL_CHATTRS_122 = $(GLOBAL_CHATTRS_106)
GLOBAL_CHATTRS_123 = $(GLOBAL_CHATTRS_106)
GLOBAL_CHATTRS_124 = $(GLOBAL_CHATTRS_106) attrs
GLOBAL_CHATTRS_125 = $(GLOBAL_CHATTRS_124)
GLOBAL_CHATTRS_126 = $(GLOBAL_CHATTRS_124)
GLOBAL_CHATTRS_127 = $(GLOBAL_CHATTRS_124)
GLOBAL_CHATTRS_128 = $(GLOBAL_CHATTRS_124)
GLOBAL_CHATTRS_129 = $(GLOBAL_CHATTRS_124)
GLOBAL_CHATTRS_130 = $(GLOBAL_CHATTRS_124)
GLOBAL_CHATTRS_131 = $(GLOBAL_CHATTRS_124)
GLOBAL_CHATTRS_132 = $(GLOBAL_CHATTRS_124)
GLOBAL_CHATTRS_133 = $(GLOBAL_CHATTRS_124)
GLOBAL_CHATTRS_134 = $(GLOBAL_CHATTRS_124)
GLOBAL_CHATTRS_134.0.1 = $(GLOBAL_CHATTRS_124)
GLOBAL_CHATTRS_134.0.2 = $(GLOBAL_CHATTRS_124)
GLOBAL_CHATTRS_135 = $(GLOBAL_CHATTRS_124)
GLOBAL_CHATTRS_136 = $(GLOBAL_CHATTRS_124)
GLOBAL_CHATTRS_137 = $(GLOBAL_CHATTRS_124)
GLOBAL_CHATTRS_138 = $(GLOBAL_CHATTRS_124)
GLOBAL_CHATTRS_139 = $(GLOBAL_CHATTRS_124)
GLOBAL_CHATTRS_140 = $(GLOBAL_CHATTRS_124)
GLOBAL_CHATTRS_141 = $(GLOBAL_CHATTRS_124)
GLOBAL_CHATTRS_142 = $(GLOBAL_CHATTRS_124)
GLOBAL_CHATTRS_143 = $(GLOBAL_CHATTRS_124)
GLOBAL_CHATTRS_144 = $(GLOBAL_CHATTRS_124)
GLOBAL_CHATTRS_145 = $(GLOBAL_CHATTRS_124)
GLOBAL_CHATTRS_146 = $(GLOBAL_CHATTRS_124)
GLOBAL_CHATTRS_147 = $(GLOBAL_CHATTRS_124)
GLOBAL_CHATTRS_148 = $(GLOBAL_CHATTRS_124)
GLOBAL_CHATTRS_149 = $(GLOBAL_CHATTRS_124)
GLOBAL_CHATTRS_150 = $(GLOBAL_CHATTRS_124)
GLOBAL_CHATTRS_151 = $(GLOBAL_CHATTRS_124)
GLOBAL_CHATTRS_151.0.1 = $(GLOBAL_CHATTRS_124)
GLOBAL_CHATTRS_152 = $(GLOBAL_CHATTRS_124)
GLOBAL_CHATTRS_153 = $(GLOBAL_CHATTRS_124)
GLOBAL_CHATTRS_154 = $(GLOBAL_CHATTRS_124)
GLOBAL_CHATTRS_155 = $(GLOBAL_CHATTRS_124)
GLOBAL_CHATTRS_156 = $(GLOBAL_CHATTRS_124)
GLOBAL_CHATTRS_157 = $(GLOBAL_CHATTRS_124)
GLOBAL_CHATTRS_158 = $(GLOBAL_CHATTRS_124)
GLOBAL_CHATTRS_159 = $(GLOBAL_CHATTRS_124)
GLOBAL_CHATTRS_160 = $(GLOBAL_CHATTRS_124)
GLOBAL_CHATTRS_161 = $(GLOBAL_CHATTRS_124)
GLOBAL_CHATTRS_162 = $(GLOBAL_CHATTRS_124)
GLOBAL_CHATTRS_163 = $(GLOBAL_CHATTRS_124)
GLOBAL_CHATTRS_164 = $(GLOBAL_CHATTRS_124)
GLOBAL_CHATTRS_165 = $(GLOBAL_CHATTRS_124)
GLOBAL_CHATTRS_166 = $(GLOBAL_CHATTRS_124)
GLOBAL_CHATTRS_167 = $(GLOBAL_CHATTRS_124)
GLOBAL_CHATTRS_168 = $(GLOBAL_CHATTRS_124)
GLOBAL_CHATTRS_169 = $(GLOBAL_CHATTRS_124)
GLOBAL_CHATTRS_170 = $(GLOBAL_CHATTRS_124)
GLOBAL_CHATTRS_171 = $(GLOBAL_CHATTRS_124)
GLOBAL_CHATTRS_172 = $(GLOBAL_CHATTRS_124)
GLOBAL_CHATTRS_173 = $(GLOBAL_CHATTRS_124)
GLOBAL_CHATTRS_174.0.0.0.0.0 = $(GLOBAL_CHATTRS_124)
GLOBAL_CHATTRS_175.0.0.0.0.0 = $(GLOBAL_CHATTRS_124)
GLOBAL_CHATTRS_175.0.0.0.1.0 = $(GLOBAL_CHATTRS_124)
GLOBAL_CHATTRS_175.0.0.0.2.0 = $(GLOBAL_CHATTRS_124)
GLOBAL_CHATTRS = $(GLOBAL_CHATTRS_$(BRANCHID))

SOLARIS.PY=PYTHONPATH=$(PROTO_AREA)/usr/lib/python2.6/vendor-packages \
	./importer.py -b 0.$(BRANCHID) $(EXTRA_OPTIONS) -T \*.py \
	$(GLOBAL_CHATTRS:%= -G %) $(ARCH_DEFINES:%= -m %) \
	-p $(PROTO_AREA) $(EXTRA_ENTIRE_CONTENTS:%= -E %)

#
# always remove the following (editable) files from packages we bulk import;
# we're doing this until the necessary actions are available.  For now,
# cache as-installed versions.
#
ELIDED_FILES_BASE=			\
	boot/solaris/devicedb/master	\
	etc/hba.conf			\
	etc/ima.conf			\
	etc/inet/services		\
	etc/mpapi.conf

ELIDED_FILES_ATTR =			\
	etc/security/auth_attr		\
	etc/security/exec_attr		\
	etc/security/prof_attr		\
	etc/user_attr

ELIDED_FILES_86 = $(ELIDED_FILES_BASE) $(ELIDED_FILES_ATTR) etc/devlink.tab
ELIDED_FILES_89 = $(ELITED_FILES_86) kernel/drv/sd.conf
ELIDED_FILES_90 = $(ELIDED_FILES_89)
ELIDED_FILES_91 = $(ELIDED_FILES_89)
ELIDED_FILES_92 = $(ELIDED_FILES_89)
ELIDED_FILES_93 = $(ELIDED_FILES_89)
ELIDED_FILES_94 = $(ELIDED_FILES_89)
ELIDED_FILES_95 = $(ELIDED_FILES_89)
ELIDED_FILES_96 = $(ELIDED_FILES_89)
ELIDED_FILES_97 = $(ELIDED_FILES_89)
ELIDED_FILES_98 = $(ELIDED_FILES_89)
ELIDED_FILES_99 = $(ELIDED_FILES_89)
ELIDED_FILES_100a = $(ELIDED_FILES_BASE) $(ELIDED_FILES_ATTR) kernel/drv/sd.conf
ELIDED_FILES_101 = $(ELIDED_FILES_100a)
ELIDED_FILES_101a = $(ELIDED_FILES_100a)
ELIDED_FILES_105 = $(ELIDED_FILES_100a)
ELIDED_FILES_106 = $(ELIDED_FILES_BASE) $(ELIDED_FILES_ATTR)
ELIDED_FILES_107 = $(ELIDED_FILES_106)
ELIDED_FILES_108 = $(ELIDED_FILES_106)
ELIDED_FILES_109 = $(ELIDED_FILES_106)
ELIDED_FILES_110 = $(ELIDED_FILES_106)
ELIDED_FILES_111 = $(ELIDED_FILES_106)
ELIDED_FILES_111a = $(ELIDED_FILES_106)
ELIDED_FILES_116 = $(ELIDED_FILES_106)
ELIDED_FILES_117 = $(ELIDED_FILES_106)
ELIDED_FILES_118 = $(ELIDED_FILES_106)
ELIDED_FILES_119 = $(ELIDED_FILES_106)
ELIDED_FILES_120 = $(ELIDED_FILES_106)
ELIDED_FILES_121 = $(ELIDED_FILES_106)
ELIDED_FILES_122 = $(ELIDED_FILES_106)
ELIDED_FILES_123 = $(ELIDED_FILES_106)
ELIDED_FILES_124 = $(ELIDED_FILES_BASE)
ELIDED_FILES_125 = $(ELIDED_FILES_BASE)
ELIDED_FILES_126 = $(ELIDED_FILES_BASE)
ELIDED_FILES_127 = $(ELIDED_FILES_BASE)
ELIDED_FILES_128 = $(ELIDED_FILES_BASE)
ELIDED_FILES_129 = $(ELIDED_FILES_BASE)
ELIDED_FILES_130 = $(ELIDED_FILES_BASE)
ELIDED_FILES_131 = $(ELIDED_FILES_BASE)
ELIDED_FILES_132 = $(ELIDED_FILES_BASE)
ELIDED_FILES_133 = $(ELIDED_FILES_BASE)
ELIDED_FILES_134 = $(ELIDED_FILES_BASE)
ELIDED_FILES_134.0.1 = $(ELIDED_FILES_BASE)
ELIDED_FILES_134.0.2 = $(ELIDED_FILES_BASE)
ELIDED_FILES_135 = $(ELIDED_FILES_BASE)
ELIDED_FILES_136 = $(ELIDED_FILES_BASE)
ELIDED_FILES_137 = $(ELIDED_FILES_BASE)
ELIDED_FILES_138 = $(ELIDED_FILES_BASE)
ELIDED_FILES_139 = $(ELIDED_FILES_BASE)
ELIDED_FILES_140 = $(ELIDED_FILES_BASE)
ELIDED_FILES_141 = $(ELIDED_FILES_BASE)
ELIDED_FILES_142 = $(ELIDED_FILES_BASE)
ELIDED_FILES_143 = $(ELIDED_FILES_BASE)
ELIDED_FILES_144 = $(ELIDED_FILES_BASE)
ELIDED_FILES_145 = $(ELIDED_FILES_BASE)
ELIDED_FILES_146 = $(ELIDED_FILES_BASE)
ELIDED_FILES_147 = $(ELIDED_FILES_BASE)
ELIDED_FILES_148 = $(ELIDED_FILES_BASE)
ELIDED_FILES_149 = $(ELIDED_FILES_BASE)
ELIDED_FILES_150 = $(ELIDED_FILES_BASE)
ELIDED_FILES_151 = $(ELIDED_FILES_BASE)
ELIDED_FILES_151.0.1 = $(ELIDED_FILES_BASE)
ELIDED_FILES_152 = $(ELIDED_FILES_BASE)
ELIDED_FILES_153 = $(ELIDED_FILES_BASE)
ELIDED_FILES_154 = $(ELIDED_FILES_BASE)
ELIDED_FILES_155 = $(ELIDED_FILES_BASE)
ELIDED_FILES_156 = $(ELIDED_FILES_BASE)
ELIDED_FILES_157 = $(ELIDED_FILES_BASE)
ELIDED_FILES_158 = $(ELIDED_FILES_BASE)
ELIDED_FILES_159 = $(ELIDED_FILES_BASE)
ELIDED_FILES_160 = $(ELIDED_FILES_BASE)
ELIDED_FILES_161 = $(ELIDED_FILES_BASE)
ELIDED_FILES_162 = $(ELIDED_FILES_BASE)
ELIDED_FILES_163 = $(ELIDED_FILES_BASE)
ELIDED_FILES_164 = $(ELIDED_FILES_BASE)
ELIDED_FILES_165 = $(ELIDED_FILES_BASE)
ELIDED_FILES_166 = $(ELIDED_FILES_BASE)
ELIDED_FILES_167 = $(ELIDED_FILES_BASE)
ELIDED_FILES_168 = $(ELIDED_FILES_BASE)
ELIDED_FILES_169 = $(ELIDED_FILES_BASE)
ELIDED_FILES_170 = $(ELIDED_FILES_BASE)
ELIDED_FILES_171 = $(ELIDED_FILES_BASE)
ELIDED_FILES_172 = $(ELIDED_FILES_BASE)
ELIDED_FILES_173 = $(ELIDED_FILES_BASE)
ELIDED_FILES_174.0.0.0.0.0 = $(ELIDED_FILES_BASE)
ELIDED_FILES_175.0.0.0.0.0 = $(ELIDED_FILES_BASE)
ELIDED_FILES_175.0.0.0.1.0 = $(ELIDED_FILES_BASE)
ELIDED_FILES_175.0.0.0.2.0 = $(ELIDED_FILES_BASE)
ELIDED_FILES = $(ELIDED_FILES_$(BRANCHID))

#
# these files get placed into proto area from per-build cached versions
#
CACHED_FILES_BASE=							\
	$(ELIDED_FILES)							\
	boot/grub/menu.lst						\
	boot/grub/splash.xpm.gz						\
	etc/inet/hosts							\
	etc/zones/SUNWblank.xml						\
	etc/zones/SUNWdefault.xml					\
	lib/svc/method/fs-usr						\
	lib/svc/method/sshd						\
	lib/svc/method/svc-coreadm					\
	lib/svc/method/svc-dlmgmtd					\
	usr/jdk/instances/jdk1.6.0/jre/lib/fontconfig.properties	\
	usr/lib/vp-services						\
	usr/lib/vp-shares						\
	var/svc/manifest/system/coreadm.xml				\
	var/svc/profile/generic_limited_net.xml				\
	var/svc/profile/generic_open.xml

CACHED_FILES_86 = $(CACHED_FILES_BASE)
CACHED_FILES_89 = $(CACHED_FILES_BASE)
CACHED_FILES_90 = $(CACHED_FILES_BASE)
CACHED_FILES_91 = $(CACHED_FILES_BASE)
CACHED_FILES_92 = $(CACHED_FILES_BASE)
CACHED_FILES_93 = $(CACHED_FILES_BASE)
CACHED_FILES_94 = $(CACHED_FILES_BASE)
CACHED_FILES_95 = $(CACHED_FILES_BASE)
CACHED_FILES_96 = $(CACHED_FILES_BASE)
CACHED_FILES_97 = $(CACHED_FILES_BASE)
CACHED_FILES_98 = $(CACHED_FILES_BASE)
CACHED_FILES_99 = $(CACHED_FILES_BASE)					\
	etc/security/policy.conf					\
	root/.bashrc							\
	root/.profile
CACHED_FILES_100a = $(CACHED_FILES_99)
CACHED_FILES_101 = $(CACHED_FILES_99)					\
	etc/mailcap							\
	etc/mime.types
CACHED_FILES_101a = $(CACHED_FILES_101)					\
	boot/solaris.xpm						\
	etc/skel/.bashrc						\
	etc/skel/.profile						\
	lib/svc/method/svc-ipagent					\
	lib/svc/method/xvm-vnc-config					\
	kernel/drv/nvidia.conf						\
	usr/lib/xen/bin/ipagent						\
	usr/X11/lib/xscreensaver/config/opensolaris-logo.png		\
	var/svc/manifest/application/graphical-login/gdm.xml		\
	var/svc/manifest/system/ipagent.xml				\
	var/svc/manifest/system/xvm/vnc-config.xml
CACHED_FILES_105 = $(CACHED_FILES_101a)
CACHED_FILES_106 = $(CACHED_FILES_101a)
CACHED_FILES_107 = $(CACHED_FILES_101a)					\
	var/svc/manifest/application/x11/x11-server.xml
CACHED_FILES_108 = $(CACHED_FILES_107)
CACHED_FILES_109 = $(CACHED_FILES_107)
CACHED_FILES_110 = $(CACHED_FILES_107)
CACHED_FILES_111 = $(CACHED_FILES_107)
CACHED_FILES_111a = $(CACHED_FILES_107)					\
	etc/zones/SUNWtsoldef.xml					\
	usr/jdk/instances/jdk1.6.0/jre/lib/fontconfig.OpenSolaris.bfc	\
	usr/jdk/instances/jdk1.6.0/jre/lib/fontconfig.OpenSolaris.properties.src \
	usr/lib/brand/labeled/config.xml				\
	usr/lib/brand/labeled/platform.xml
CACHED_FILES_116 =
CACHED_FILES_117 =
CACHED_FILES_118 =
CACHED_FILES_119 =
CACHED_FILES_120 =
CACHED_FILES_121 =
CACHED_FILES_122 =
CACHED_FILES_123 =
CACHED_FILES_124 =
CACHED_FILES_125 =
CACHED_FILES_126 =
CACHED_FILES_127 =
CACHED_FILES_128 =
CACHED_FILES_129 =
CACHED_FILES_130 =
CACHED_FILES_131 =
CACHED_FILES_132 =
CACHED_FILES_133 =
CACHED_FILES_134 =
CACHED_FILES_134.0.1 =
CACHED_FILES_134.0.2 =
CACHED_FILES_135 =
CACHED_FILES_136 =
CACHED_FILES_137 =
CACHED_FILES_138 =
CACHED_FILES_139 =
CACHED_FILES_140 =
CACHED_FILES_141 =
CACHED_FILES_142 =
CACHED_FILES_143 =
CACHED_FILES_144 =
CACHED_FILES_145 =
CACHED_FILES_146 =
CACHED_FILES_147 =
CACHED_FILES_148 =
CACHED_FILES_149 =
CACHED_FILES_150 =
CACHED_FILES_151 =
CACHED_FILES_151.0.1 =
CACHED_FILES_152 =
CACHED_FILES_153 =
CACHED_FILES_154 =
CACHED_FILES_155 =
CACHED_FILES_156 =
CACHED_FILES_157 =
CACHED_FILES_158 =
CACHED_FILES_159 =
CACHED_FILES_160 =
CACHED_FILES_161 =
CACHED_FILES_162 =
CACHED_FILES_163 =
CACHED_FILES_164 =
CACHED_FILES_165 =
CACHED_FILES_166 =
CACHED_FILES_167 =
CACHED_FILES_168 =
CACHED_FILES_169 =
CACHED_FILES_170 =
CACHED_FILES_171 =
CACHED_FILES_172 =
CACHED_FILES_173 =
CACHED_FILES_174.0.0.0.0.0 =
CACHED_FILES_175.0.0.0.0.0 =
CACHED_FILES_175.0.0.0.1.0 =
CACHED_FILES_175.0.0.0.2.0 =
CACHED_FILES = $(CACHED_FILES_$(BRANCHID))

FIX_FILES_BASE =				\
	$(CACHED_FILES)				\
	etc/driver_aliases			\
	etc/name_to_major			\
	etc/nsswitch.conf			\
	etc/pam.conf				\
	etc/passwd				\
	etc/power.conf				\
	etc/shadow				\
	usr/bin/ksh				\
	usr/has/bin/sh				\
	usr/has/bin/vi				\
	usr/jdk/instances/jdk1.6.0/LICENSE	\
	usr/jdk/instances/jdk1.6.0/README.html	\
	usr/jdk/instances/jdk1.6.0/jre/LICENSE	\
	usr/jdk/instances/jdk1.6.0/jre/README	\
	usr/share/applications/services.desktop	\
	usr/share/applications/shares.desktop

FIX_FILES_86 =				\
	$(FIX_FILES_BASE)		\
	boot/solaris/filelist.ramdisk	\
	etc/X11/gdm/custom.conf		\
	etc/release			\
	etc/svc/global_repo.db		\
	etc/svc/nonglobal_repo.db	\
	etc/user_attr.cdonly		\
	usr/share/man/man.cf		\
	usr/share/man/missing.man
FIX_FILES_89 = $(FIX_FILES_86)
FIX_FILES_90 = $(FIX_FILES_86)
FIX_FILES_91 = $(FIX_FILES_86)
FIX_FILES_92 = $(FIX_FILES_86)
FIX_FILES_93 = $(FIX_FILES_86)
FIX_FILES_94 = $(FIX_FILES_86)
FIX_FILES_95 = $(FIX_FILES_86)
FIX_FILES_96 = $(FIX_FILES_86)
FIX_FILES_97 = $(FIX_FILES_BASE)	\
	boot/solaris/filelist.ramdisk	\
	etc/release			\
	etc/svc/global_repo.db		\
	etc/svc/nonglobal_repo.db	\
	usr/share/man/man.cf		\
	usr/share/man/missing.man
FIX_FILES_98 = $(FIX_FILES_BASE)	\
	usr/share/man/man.cf
FIX_FILES_99 = $(FIX_FILES_98)
FIX_FILES_100a = $(FIX_FILES_98)	\
	lib/svc/method/svc-hostid	\
	usr/sbin/extract_hostid
FIX_FILES_101 = $(FIX_FILES_99)
FIX_FILES_101a = $(FIX_FILES_99)
FIX_FILES_105 = $(FIX_FILES_BASE)
FIX_FILES_106 = $(FIX_FILES_BASE)
FIX_FILES_107 = $(FIX_FILES_BASE)
FIX_FILES_108 = $(FIX_FILES_BASE)
FIX_FILES_109 = $(FIX_FILES_BASE)
FIX_FILES_110 = $(FIX_FILES_BASE)
FIX_FILES_111 = $(FIX_FILES_BASE)
FIX_FILES_111a = $(FIX_FILES_BASE)
FIX_FILES_116 = $(FIX_FILES_BASE)
FIX_FILES_117 = $(FIX_FILES_BASE)
FIX_FILES_118 = $(FIX_FILES_BASE)
FIX_FILES_119 = $(FIX_FILES_BASE)
FIX_FILES_120 = $(FIX_FILES_BASE)
FIX_FILES_121 =				\
	driver_aliases			\
	ksh				\
	name_to_major			\
	nsswitch.conf			\
	pam.conf			\
	passwd				\
	services.desktop		\
	sh				\
	shadow				\
	shares.desktop			\
	vi
FIX_FILES_122 = $(FIX_FILES_121)
FIX_FILES_123 = $(FIX_FILES_121)
FIX_FILES_124 = $(FIX_FILES_121)
FIX_FILES_125 =				\
	ksh				\
	nsswitch.conf			\
	pam.conf			\
	passwd				\
	services.desktop		\
	sh				\
	shadow				\
	shares.desktop			\
	vi
FIX_FILES_126 = $(FIX_FILES_125)
FIX_FILES_127 = $(FIX_FILES_125)
FIX_FILES_128 = $(FIX_FILES_125)
FIX_FILES_129 = $(FIX_FILES_125)
FIX_FILES_130 = $(FIX_FILES_125)
FIX_FILES_131 =				\
	ksh				\
	nsswitch.conf			\
	pam.conf			\
	passwd				\
	services.desktop		\
	shadow				\
	shares.desktop
FIX_FILES_132 = $(FIX_FILES_131)
FIX_FILES_133 = $(FIX_FILES_131)	\
	auth_attr			\
	exec_attr			\
	prof_attr			\
	user_attr
FIX_FILES_134 = $(FIX_FILES_133)
FIX_FILES_134.0.1 = $(FIX_FILES_133)
FIX_FILES_134.0.2 = $(FIX_FILES_133)
FIX_FILES_135 = $(FIX_FILES_133)
FIX_FILES_136 =				\
	services.desktop		\
	shares.desktop
FIX_FILES_137 = $(FIX_FILES_136)
FIX_FILES_138 = $(FIX_FILES_136)
FIX_FILES_139 = $(FIX_FILES_136)
FIX_FILES_140 = $(FIX_FILES_136)
FIX_FILES_141 = $(FIX_FILES_136)
FIX_FILES_142 = $(FIX_FILES_136)
FIX_FILES_143 = $(FIX_FILES_136)
FIX_FILES_144 = $(FIX_FILES_136)
FIX_FILES_145 = $(FIX_FILES_136)
FIX_FILES_146 = $(FIX_FILES_136)
FIX_FILES_147 = $(FIX_FILES_136)
FIX_FILES_148 = $(FIX_FILES_136)
FIX_FILES_149 = $(FIX_FILES_136)
FIX_FILES_150 = $(FIX_FILES_136)
FIX_FILES_151 = $(FIX_FILES_136)
FIX_FILES_151.0.1 = $(FIX_FILES_136)
FIX_FILES_152 = $(FIX_FILES_136)
FIX_FILES_153 = $(FIX_FILES_136)
FIX_FILES_154 = $(FIX_FILES_136)
FIX_FILES_155 = $(FIX_FILES_136)
FIX_FILES_156 =
FIX_FILES_157 =
FIX_FILES_158 =
FIX_FILES_159 =
FIX_FILES_160 =
FIX_FILES_161 =
FIX_FILES_162 =
FIX_FILES_163 =
FIX_FILES_164 =
FIX_FILES_165 =
FIX_FILES_166 =
FIX_FILES_167 =
FIX_FILES_168 =
FIX_FILES_169 =
FIX_FILES_170 =
FIX_FILES_171 =
FIX_FILES_172 =
FIX_FILES_173 =
FIX_FILES_174.0.0.0.0.0 =
FIX_FILES_175.0.0.0.0.0 =
FIX_FILES_175.0.0.0.1.0 =
FIX_FILES_175.0.0.0.2.0 =
FIX_FILES = $(FIX_FILES_$(BRANCHID))

JDKFILES = LICENSE README.html
JREFILES = LICENSE README

PROG=	ksh-wrapper

OBJS=	ksh-wrapper.o

SRCS=	$(OBJS:%.o=%.c)

CFLAGS=		-O3 -v

LINTFLAGS=	-axsm

UNBUNDLED_TARGETS=		\
	ClusterTools.import	\
	ClusterTools8.import	\
	ClusterTools821.import	\
	DTraceGUI.import	\
	Eclipse.import		\
	ExuberantCTags.import	\
	GlassFishV2.import	\
	GnuDevTools.import	\
	LDomsManager.import	\
	MessageQueue41.import	\
	NetBeans.import		\
	OpenDS.import		\
	OpenJDK7.import		\
	OpenOffice.import	\
	Studio.import		\
	Webstackui.import

UNBUNDLED_CLUSTERS=		\
	Clusters.import

BUILDS=	75a			\
	79b			\
	86			\
	89			\
	90			\
	91			\
	92			\
	93			\
	94			\
	95			\
	96			\
	97			\
	98			\
	99			\
	100a			\
	101			\
	101a			\
	105			\
	106			\
	107			\
	108			\
	109			\
	110			\
	111			\
	111a			\
	116			\
	117			\
	118			\
	119			\
	120			\
	121			\
	122			\
	123			\
	124			\
	125			\
	126			\
	127			\
	128			\
	129			\
	130			\
	131			\
	132			\
	133			\
	134			\
	134.0.1			\
	134.0.2			\
	135			\
	136			\
	137			\
	138			\
	139			\
	140			\
	141			\
	142			\
	143			\
	144			\
	145			\
	146			\
	147			\
	148			\
	149			\
	150			\
	151			\
	151.0.1			\
	152			\
	153			\
	154			\
	155			\
	156			\
	157			\
	158			\
	159			\
	160			\
	161			\
	162			\
	163			\
	164			\
	165			\
	166			\
	167			\
	168			\
	169			\
	170			\
	171			\
	172			\
	173			\
	174.0.0.0.0.0		\
	175.0.0.0.0.0		\
	175.0.0.0.1.0		\
	175.0.0.0.2.0

#
# Starting in build 80, filelist.ramdisk began moving between various
# packages.
#
FILELIST_RAMDISK_PKG_$(BRANCHID)	= SUNWckr
FILELIST_RAMDISK_PKG_79b		= SUNWcakr.i
FILELIST_RAMDISK_PKG_75a		= SUNWcakr.i
FILELIST_RAMDISK_PKG_74			= SUNWcakr.i
FILELIST_RAMDISK_PKG_72			= SUNWcakr.i
FILELIST_RAMDISK_PKG_71			= SUNWcakr.i

default:	$(BRANCHID)/redist_import

cluster.import:	$(WOS_PKGS)/.clustertoc Makefile
	./clustertoc2import.py $(WOS_PKGS)/.clustertoc | \
	sed "s/version 2.2.1a/version 2.2.1.1/" > $@

proto/etc/user_attr.cdonly: proto $(BRANCHID)/user_attr
	( cat $(BRANCHID)/user_attr; \
	  echo "jack::::profiles=Primary Administrator;roles=root") > $@

$(BRANCHID)/driver_aliases:	$(BRANCHID)/redist_cluster cluster.import
	./get_file_from_pkg.py $(WOS_PKGS)/SUNWcsd etc/driver_aliases | \
	./driver_names.py $(INCLUDE_PATH_$(BRANCHID)) \
	$(BRANCHID)/redist_cluster > $@

$(BRANCHID)/name_to_major:	$(BRANCHID)/redist_cluster cluster.import
	./get_file_from_pkg.py $(WOS_PKGS)/SUNWcsd etc/name_to_major | \
	./driver_names.py $(INCLUDE_PATH_$(BRANCHID)) \
	$(BRANCHID)/redist_cluster > $@

$(BRANCHID)/nsswitch.conf:	Makefile
	./get_file_from_pkg.py $(WOS_PKGS)/SUNWcsr etc/nsswitch.files > $@

proto/etc/X11/gdm/custom.conf:	proto Makefile
	./get_file_from_pkg.py $(WOS_PKGS)/SUNWgnome-display-mgr-root	\
	etc/X11/gdm/custom.conf | nawk '/^\[daemon\]/ { print $$0;	\
			    print "AutomaticLoginEnable=true";		\
			    print "AutomaticLogin=jack";		\
			    print "GdmXserverTimeout=30";		\
			    continue }  { print $$0 }' > $@

proto/boot/solaris/filelist.ramdisk:	proto
	(./get_file_from_pkg.py \
	    $(WOS_PKGS)/$(FILELIST_RAMDISK_PKG_$(BRANCHID)) \
	    boot/solaris/filelist.ramdisk; \
	    echo etc/zfs/zpool.cache) > $@

$(BRANCHID)/pam.conf:
	(./get_file_from_pkg.py $(WOS_PKGS)/SUNWcsr etc/pam.conf;	\
	echo "gdm-autologin auth  required    pam_unix_cred.so.1";	\
	echo "gdm-autologin auth  sufficient  pam_allow.so.1";		\
	echo "gdm-autologin account  sufficient  pam_allow.so.1";	\
	echo "gdm-autologin session  sufficient  pam_allow.so.1";	\
	echo "gdm-autologin password  sufficient  pam_allow.so.1"	\
	) > $@

proto/etc/svc/global_repo.db:	proto
	./get_file_from_pkg.py $(WOS_PKGS)/SUNWcsr lib/svc/seed/global.db > $@

proto/etc/svc/nonglobal_repo.db:	proto
	./get_file_from_pkg.py $(WOS_PKGS)/SUNWcsr lib/svc/seed/nonglobal.db > $@

# fix booting on non-sse capable cpus until 6332924 gets fixed
proto/lib/libc.so.1: proto
	./get_file_from_pkg.py $(WOS_PKGS)/SUNWcslr lib/libc.so.1 > $@
	/usr/bin/elfedit -e 'cap:hw1 -and -cmp sse' $@

proto/lib/svc/method/svc-hostid: proto 100a/svc-hostid
	cp 100a/svc-hostid $@

proto/usr/share/man/missing.man:	proto	missing.man
	cp missing.man $@

proto/etc/release:	proto
	./get_file_from_pkg.py $(WOS_PKGS)/SUNWsolnm etc/release | head -1 | \
	sed 's/.*snv_/                  OpenSolaris 2008.05 snv_/' \
	> $@
	cat release.figlet >> $@

proto/usr/share/man/man.cf:	proto
	./get_file_from_pkg.py $(WOS_PKGS)/SUNWman usr/share/man/man.cf | \
	sed \
	'/MANSECTS/s/$$/,1openssl,3openssl,5openssl,7openssl/' \
	> $@

$(BRANCHID)/ksh:	$(PROG)
	cp $(PROG) $@

$(BRANCHID)/shares.desktop:
	./get_file_from_pkg.py $(WOS_PKGS)/SUNWgnome-system-tools \
	usr/share/applications/shares.desktop | \
	./desktop_exec.sh /usr/lib/vp-shares > $@

$(BRANCHID)/services.desktop: proto
	./get_file_from_pkg.py $(WOS_PKGS)/SUNWgnome-system-tools \
	usr/share/applications/services.desktop | \
	./desktop_exec.sh /usr/lib/vp-services > $@

#
# change root's default shell, homedir, password
#
$(BRANCHID)/passwd:	Makefile
	(./get_file_from_pkg.py $(WOS_PKGS)/SUNWcsr etc/passwd | nawk -F: \
	'/^root/{ print "root:x:0:0:Super-User:/root:/usr/bin/bash";continue} {print $$0}') > $@

$(BRANCHID)/shadow:	Makefile
	(./get_file_from_pkg.py $(WOS_PKGS)/SUNWcsr etc/shadow | nawk -F: \
	'/^root/{ print "root:$$5$$VgppCOxA$$ycFmYW4ObRRHhtsGEygDdexk5bugqgSiaSR9niNCouC:14146::::::";continue} {print $$0}') > $@

$(BRANCHID)/sh:	Makefile
	./get_file_from_pkg.py $(WOS_PKGS)/SUNWcsr sbin/sh > $@

$(BRANCHID)/vi:	Makefile
	./get_file_from_pkg.py $(WOS_PKGS)/SUNWcsu usr/bin/edit > $@

$(BRANCHID)/auth_attr:	Makefile
	./get_file_from_pkg.py $(WOS_PKGS)/SUNWcsr etc/security/auth_attr > $@

$(BRANCHID)/exec_attr:	Makefile
	./get_file_from_pkg.py $(WOS_PKGS)/SUNWcsr etc/security/exec_attr > $@

$(BRANCHID)/prof_attr:	Makefile
	./get_file_from_pkg.py $(WOS_PKGS)/SUNWcsr etc/security/prof_attr > $@

$(BRANCHID)/user_attr:	Makefile
	./get_file_from_pkg.py $(WOS_PKGS)/SUNWcsr etc/user_attr > $@

proto/usr/sbin/extract_hostid:	proto ../misc/extract_hostid
	cp ../misc/extract_hostid $@

$(JDKFILES:%=proto/usr/jdk/instances/jdk1.6.0/%):	proto DLJ/$(@F)
	cp DLJ/$(@F) $@

$(JREFILES:%=proto/usr/jdk/instances/jdk1.6.0/jre/%):	proto DLJ/$(@F)
	cp DLJ/$(@F) $@

$(CACHED_FILES:%=proto/%):	proto $(BRANCHID)/$(@F) Makefile
	cat $(BRANCHID)/$(@F) > $@

proto:	Makefile
	mkdir -p proto/boot/grub
	mkdir -p proto/boot/solaris/devicedb
	mkdir -p proto/etc/X11/gdm
	mkdir -p proto/etc/inet
	mkdir -p proto/etc/security
	mkdir -p proto/etc/skel
	mkdir -p proto/etc/svc
	mkdir -p proto/etc/zones
	mkdir -p proto/kernel/drv
	mkdir -p proto/lib/svc/method
	mkdir -p proto/root
	mkdir -p proto/usr/X11/lib/xscreensaver/config
	mkdir -p proto/usr/bin
	mkdir -p proto/usr/has/bin
	mkdir -p proto/usr/jdk/instances/jdk1.6.0/jre/lib
	mkdir -p proto/usr/lib/brand/labeled
	mkdir -p proto/usr/lib/xen/bin
	mkdir -p proto/usr/sbin
	mkdir -p proto/usr/share/applications
	mkdir -p proto/usr/share/man
	mkdir -p proto/var/svc/manifest/application/graphical-login
	mkdir -p proto/var/svc/manifest/application/x11
	mkdir -p proto/var/svc/manifest/system/xvm
	mkdir -p proto/var/svc/profile

INCLUDE_PATH_75a = 75a:73:72:71:00
INCLUDE_PATH_79b = 79b:78:77:76:$(INCLUDE_PATH_75a)
INCLUDE_PATH_84 = 84:83:82:81:80:$(INCLUDE_PATH_79b)
INCLUDE_PATH_85 = 85:$(INCLUDE_PATH_84)
INCLUDE_PATH_86 = 86:$(INCLUDE_PATH_85)
INCLUDE_PATH_89 = 89:88:87:$(INCLUDE_PATH_86)
INCLUDE_PATH_90 = 90:$(INCLUDE_PATH_89)
INCLUDE_PATH_91 = 91:$(INCLUDE_PATH_90)
INCLUDE_PATH_92 = 92:$(INCLUDE_PATH_91)
INCLUDE_PATH_93 = 93:$(INCLUDE_PATH_92)
INCLUDE_PATH_94 = 94:$(INCLUDE_PATH_93)
INCLUDE_PATH_95 = 95:$(INCLUDE_PATH_94)
INCLUDE_PATH_96 = 96:$(INCLUDE_PATH_95)
INCLUDE_PATH_97 = 97:$(INCLUDE_PATH_96)
INCLUDE_PATH_98 = 98:$(INCLUDE_PATH_97)
INCLUDE_PATH_99 = 99:$(INCLUDE_PATH_98)
INCLUDE_PATH_100a = 100a:$(INCLUDE_PATH_99)
INCLUDE_PATH_101 = 101:$(INCLUDE_PATH_100a)
INCLUDE_PATH_101a = 101a:$(INCLUDE_PATH_101)
INCLUDE_PATH_105 = 105:104:103:102:$(INCLUDE_PATH_101a)
INCLUDE_PATH_106 = 106:$(INCLUDE_PATH_105)
INCLUDE_PATH_107 = 107:$(INCLUDE_PATH_106)
INCLUDE_PATH_108 = 108:$(INCLUDE_PATH_107)
INCLUDE_PATH_109 = 109:$(INCLUDE_PATH_108)
INCLUDE_PATH_110 = 110:$(INCLUDE_PATH_109)
INCLUDE_PATH_111 = 111:$(INCLUDE_PATH_110)
INCLUDE_PATH_111a = 111a:$(INCLUDE_PATH_111)
INCLUDE_PATH_116 = 116:$(INCLUDE_PATH_111a)
INCLUDE_PATH_117 = 117:$(INCLUDE_PATH_116)
INCLUDE_PATH_118 = 118:$(INCLUDE_PATH_117)
INCLUDE_PATH_119 = 119:$(INCLUDE_PATH_118)
INCLUDE_PATH_120 = 120:$(INCLUDE_PATH_119)
INCLUDE_PATH_121 = 121:$(INCLUDE_PATH_120)
INCLUDE_PATH_122 = 122:$(INCLUDE_PATH_121)
INCLUDE_PATH_123 = 123:$(INCLUDE_PATH_122)
INCLUDE_PATH_124 = 124:$(INCLUDE_PATH_123)
INCLUDE_PATH_125 = 125:$(INCLUDE_PATH_124)
INCLUDE_PATH_126 = 126:$(INCLUDE_PATH_125)
INCLUDE_PATH_127 = 127:$(INCLUDE_PATH_126)
INCLUDE_PATH_128 = 128:$(INCLUDE_PATH_127)
INCLUDE_PATH_129 = 129:$(INCLUDE_PATH_128)
INCLUDE_PATH_130 = 130:$(INCLUDE_PATH_129)
INCLUDE_PATH_131 = 131:$(INCLUDE_PATH_130)
INCLUDE_PATH_132 = 132:$(INCLUDE_PATH_131)
INCLUDE_PATH_133 = 133:$(INCLUDE_PATH_132)
INCLUDE_PATH_134 = 134:$(INCLUDE_PATH_133)
INCLUDE_PATH_134.0.1 = 134.0.1:$(INCLUDE_PATH_134)
INCLUDE_PATH_134.0.2 = 134.0.2:$(INCLUDE_PATH_134.0.1)
INCLUDE_PATH_135 = 135:$(INCLUDE_PATH_134)
INCLUDE_PATH_136 = 136:$(INCLUDE_PATH_135)
INCLUDE_PATH_137 = 137:$(INCLUDE_PATH_136)
INCLUDE_PATH_138 = 138:$(INCLUDE_PATH_137)
INCLUDE_PATH_139 = 139:$(INCLUDE_PATH_138)
INCLUDE_PATH_140 = 140:$(INCLUDE_PATH_139)
INCLUDE_PATH_141 = 141:$(INCLUDE_PATH_140)
INCLUDE_PATH_142 = 142:$(INCLUDE_PATH_141)
INCLUDE_PATH_143 = 143:$(INCLUDE_PATH_142)
INCLUDE_PATH_144 = 144:$(INCLUDE_PATH_143)
INCLUDE_PATH_145 = 145:$(INCLUDE_PATH_144)
INCLUDE_PATH_146 = 146:$(INCLUDE_PATH_145)
INCLUDE_PATH_147 = 147:$(INCLUDE_PATH_146)
INCLUDE_PATH_148 = 148:$(INCLUDE_PATH_147)
INCLUDE_PATH_149 = 149:$(INCLUDE_PATH_148)
INCLUDE_PATH_150 = 150:$(INCLUDE_PATH_149)
INCLUDE_PATH_151 = 151:$(INCLUDE_PATH_150)
INCLUDE_PATH_151.0.1 = 151.0.1:$(INCLUDE_PATH_151)
INCLUDE_PATH_152 = 152:$(INCLUDE_PATH_151.0.1)
INCLUDE_PATH_153 = 153:$(INCLUDE_PATH_152)
INCLUDE_PATH_154 = 154:$(INCLUDE_PATH_153)
INCLUDE_PATH_155 = 155:$(INCLUDE_PATH_154)
INCLUDE_PATH_156 = 156:$(INCLUDE_PATH_155)
INCLUDE_PATH_157 = 157:$(INCLUDE_PATH_156)
INCLUDE_PATH_158 = 158:$(INCLUDE_PATH_157)
INCLUDE_PATH_159 = 159:$(INCLUDE_PATH_158)
INCLUDE_PATH_160 = 160:$(INCLUDE_PATH_159)
INCLUDE_PATH_161 = 161:$(INCLUDE_PATH_160)
INCLUDE_PATH_162 = 162:$(INCLUDE_PATH_161)
INCLUDE_PATH_163 = 163:$(INCLUDE_PATH_162)
INCLUDE_PATH_164 = 164:$(INCLUDE_PATH_163)
INCLUDE_PATH_165 = 165:$(INCLUDE_PATH_164)
INCLUDE_PATH_166 = 166:$(INCLUDE_PATH_165)
INCLUDE_PATH_167 = 167:$(INCLUDE_PATH_166)
INCLUDE_PATH_168 = 168:$(INCLUDE_PATH_167)
INCLUDE_PATH_169 = 169:$(INCLUDE_PATH_168)
INCLUDE_PATH_170 = 170:$(INCLUDE_PATH_169)
INCLUDE_PATH_171 = 171:$(INCLUDE_PATH_170)
INCLUDE_PATH_172 = 172:$(INCLUDE_PATH_171)
INCLUDE_PATH_173 = 173:$(INCLUDE_PATH_172)
INCLUDE_PATH_174.0.0.0.0.0 = 174.0.0.0.0.0:$(INCLUDE_PATH_173)
INCLUDE_PATH_175.0.0.0.0.0 = 175.0.0.0.0.0:$(INCLUDE_PATH_174.0.0.0.0.0)
INCLUDE_PATH_175.0.0.0.1.0 = 175.0.0.0.1.0:$(INCLUDE_PATH_175.0.0.0.0.0)
INCLUDE_PATH_175.0.0.0.2.0 = 175.0.0.0.2.0:$(INCLUDE_PATH_175.0.0.0.1.0)

import:	cluster.import $(FIX_FILES:%=$(BRANCHID)/%)
	$(SOLARIS.PY) -s $(REPO) -w $(WOS_PKGS) $(ELIDED_FILES:%=-D %) \
		$(INCLUDE_PATH_$(BRANCHID):%=-I %) $(BRANCHID)/all.i386

%/import:
	$(MAKE) BRANCHID=$(@:%/import=%) import

redist_import:	$(BRANCHID)/redist_cluster $(FIX_FILES:%=$(BRANCHID)/%)
	$(SOLARIS.PY) -s $(REPO) $(ALL_PKGS:%=-w %) $(ELIDED_FILES:%=-D %) \
		$(JUST_THESE_PKGS:%=-j %) $(INCLUDE_PATH_$(BRANCHID):%=-I %) \
		$(CONSOLIDATION_OPTIONS) $(BRANCHID)/redist_cluster

%/redist_import:
	if test -z "$(JUST_THESE_PKGS)"; then \
		$(MAKE) clobber; \
	fi
	$(MAKE) BRANCHID=$(@:%/redist_import=%) redist_import

$(UNBUNDLED_TARGETS:%=$(BUILDS)/%) $(UNBUNDLED_CLUSTERS:%=$(BUILDS)/%):
	$(MAKE) BRANCHID=$(@D) $(@F)

$(UNBUNDLED_TARGETS): unbundleds/$$(@:%.import=%)
	$(SOLARIS.PY) -s $(REPO) $(ALL_PKGS:%=-w %) $(ELIDED_FILES:%=-D %) \
		$(INCLUDE_PATH_$(BRANCHID):%=-I %) \
		$(REF_URIS:%=-R %) $(JUST_THESE_PKGS:%=-j %) \
		unbundleds/$(@:%.import=%)

$(UNBUNDLED_CLUSTERS): unbundleds/$$(@:%.import=%)
	$(SOLARIS.PY) -s $(REPO) $(ALL_PKGS:%=-w %) $(ELIDED_FILES:%=-D %) \
		$(INCLUDE_PATH_$(BRANCHID):%=-I %) \
		$(REF_URIS:%=-R %) $(JUST_THESE_PKGS:%=-j %) \
		unbundleds/$(@:%.import=%)

%/all_unbundleds:
	$(MAKE) BRANCHID=$(@D) $(@F)

all_unbundleds:	$(UNBUNDLED_TARGETS) $(UNBUNDLED_CLUSTERS)

#
# Used to generate the GUI Package Manager classification files from the
# current package classifications.
#
guiclassification:
	./gen_os_files.py

%/SUNWipkg %/backpublish:
	$(MAKE) BRANCHID=$(@D) $(@F)

SUNWipkg:
	PKG_REPO=$(REPO) ./publish_ips $(BRANCHID) SUNWipkg

backpublish:
	PKG_REPO=$(REPO) ./publish_ips $(BRANCHID) SUNWipkg
	PKG_REPO=$(REPO) ./publish_ips $(BRANCHID) SUNWipkg-gui
	PKG_REPO=$(REPO) ./publish_ips $(BRANCHID) SUNWipkg-gui-l10n
	PKG_REPO=$(REPO) ./publish_ips $(BRANCHID) SUNWpython-cherrypy
	PKG_REPO=$(REPO) ./publish_ips $(BRANCHID) SUNWpython-pyopenssl

clean:
	rm -f $(OBJS)
	rm -rf proto
	rm -f $(FIX_FILES:%=$(BRANCHID)/%)

clobber: clean
	rm -f $(PROG)

lint:
	$(LINT) $(LINTFLAGS) $(SRCS)

.KEEP_STATE:

FRC:
