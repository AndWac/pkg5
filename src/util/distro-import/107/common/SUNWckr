package SUNWckr
classification "System/Core"
import SUNWckr
# BEGIN NON-REDISTRIBUTABLE
$(i386_ONLY)drop kernel/drv/$(ARCH64)/bmc
$(i386_ONLY)drop kernel/drv/bmc
$(i386_ONLY)drop kernel/drv/bmc.conf
$(sparc_ONLY)drop kernel/drv/$(ARCH64)/isp
# END NON-REDISTRIBUTABLE
# XXX until new clofi hits nevada
drop kernel/drv/$(ARCH64)/lofi
$(i386_ONLY)drop kernel/drv/lofi
from SUNWclofi import
kernel/drv/$(ARCH64)/lofi
chattr kernel/drv/$(ARCH64)/lofi opensolaris.zone=global
$(i386_ONLY)kernel/drv/lofi
$(i386_ONLY)chattr kernel/drv/lofi opensolaris.zone=global
end import
add driver name=llc1 clone_perms="0666 root sys"
$(i386_ONLY)add driver name=mpt class=scsi \
$(i386_ONLY)	alias=pci1000,30 \
$(i386_ONLY)	alias=pci1000,50 \
$(i386_ONLY)	alias=pci1000,54 \
$(i386_ONLY)	alias=pci1000,56 \
$(i386_ONLY)	alias=pci1000,58 \
$(i386_ONLY)	alias=pci1000,62 \
$(i386_ONLY)	alias=pciex1000,56 \
$(i386_ONLY)	alias=pciex1000,58 \
$(i386_ONLY)	alias=pciex1000,62
add driver name=ptm clone_perms="ptmx 0666 root sys"
add driver name=softmac \
	policy="read_priv_set=net_rawaccess write_priv_set=net_rawaccess"
add driver name=tl perms="* 0666 root sys" \
	clone_perms="ticlts 0666 root sys" \
	clone_perms="ticots 0666 root sys" \
	clone_perms="ticotsord 0666 root sys"
add driver name=vnic perms="* 0666 root sys" \
	clone_perms="0666 root sys" \
	policy="read_priv_set=net_rawaccess write_priv_set=net_rawaccess"
add driver name=acpi_drv perms="* 0666 root sys"
add driver name=scsi_vhci perms="* 0666 root sys" \
	class=scsi-self-identifying policy="devctl write_priv_set=sys_devices"
add driver name=aggr perms="* 0666 root sys" \
	policy="read_priv_set=net_rawaccess write_priv_set=net_rawaccess"
add driver name=dld perms="* 0666 root sys"
#
# create link since system/device/local is dependent on
# network/datalink-management and the latter needs access to the device
# on first boot
#
add link path=dev/dld target=../devices/pseudo/dld@0:ctl
$(i386_ONLY)add driver name=amd_iommu perms="* 0644 root sys" \
$(i386_ONLY)	alias=pci1022,11ff \
$(i386_ONLY)	alias=pci1002,5a23
#
# this should really include a policy statement incorporating the
# net_observability privilege but due to a bug in add_drv(1M), 6787916,
# this cannot be specified at the moment
#
add driver name=ipnet perms="lo0 0666 root sys"
add driver name=nulldriver
add driver name=dlpistub
#
# In 2008.05, etc/boot/solaris/filelist.ramdisk was created in order to
# preserve etc/zfs/zpool.cache in the boot archive.  This is neither
# necessary nor recommended anymore so create a zero-length version of
# filelist.ramdisk in order to drop the ZFS cache file out of the boot
# archive upon update.
#
$(i386_ONLY)add file path=etc/boot/solaris/filelist.ramdisk mode=0644 \
$(i386_ONLY)	owner=root group=sys
end package
